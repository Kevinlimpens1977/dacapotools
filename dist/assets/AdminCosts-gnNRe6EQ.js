import{u as P,r as x,j as e,p as g,n as N,q as f}from"./index-CVlme_lB.js";import{g as k,A as b}from"./appCredits-CjbISwcd.js";const h={paco:.05,translate:.001};function w(){const{isSupervisor:o}=P(),[p,y]=x.useState([]),[v,j]=x.useState(!0),c=k();x.useEffect(()=>{(async()=>{try{j(!0);const t=g(N,"users"),r=await f(t),a=[];for(const l of r.docs){const n=l.data(),d={uid:l.id,email:n.email,displayName:n.displayName,apps:{}},m=g(N,"users",l.id,"apps");(await f(m)).forEach(u=>{d.apps[u.id]=u.data()}),Object.keys(d.apps).length>0&&a.push(d)}y(a)}catch(t){console.error("Error fetching costs data:",t)}finally{j(!1)}})()},[]);const i=x.useMemo(()=>{const s={totalCost:0,costPerApp:{},costPerUser:[]};return c.forEach(t=>{s.costPerApp[t]={used:0,cost:0}}),p.forEach(t=>{let r=0;Object.entries(t.apps).forEach(([a,l])=>{const n=l.totalUsedThisMonth||0,d=h[a]||.01,m=n*d;s.costPerApp[a]&&(s.costPerApp[a].used+=n,s.costPerApp[a].cost+=m),r+=m}),s.costPerUser.push({...t,totalCost:r}),s.totalCost+=r}),s.costPerUser.sort((t,r)=>r.totalCost-t.totalCost),s},[p,c]);return v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("span",{className:"material-symbols-outlined text-4xl animate-spin text-[#2860E0]",children:"sync"})}):e.jsxs("div",{className:"space-y-6 max-w-7xl",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Kosten"}),e.jsx("p",{className:"text-secondary mt-1",children:"Overzicht van platformkosten per app en gebruiker"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#2860E0] to-[#1C4DAB] rounded-xl p-6 text-white",children:[e.jsx("p",{className:"text-white/70 text-sm",children:"Totale Kosten Deze Maand"}),e.jsxs("p",{className:"text-4xl font-bold mt-2",children:["€",i.totalCost.toFixed(2)]}),e.jsxs("p",{className:"text-white/70 text-sm mt-2",children:["Gebaseerd op ",p.length," actieve gebruikers"]})]}),e.jsxs("div",{className:"bg-card rounded-xl border border-theme p-5",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Kosten per App"}),e.jsx("div",{className:"space-y-4",children:c.map(s=>{const t=b[s],r=i.costPerApp[s],a=h[s]||.01;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"size-12 rounded-lg bg-[#2860E0]/10 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-[#2860E0]",children:s==="paco"?"image":"translate"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.appName}),e.jsxs("p",{className:"text-sm text-secondary",children:[r.used," ",t.creditUnitPlural," gebruikt"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xl font-bold",children:["€",r.cost.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-secondary",children:["€",a.toFixed(3)," per ",t.creditUnit]})]})]},s)})})]}),e.jsxs("div",{className:"bg-card rounded-xl border border-theme p-5",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-amber-500",children:"settings"}),"Prijsconfiguratie",!o&&e.jsx("span",{className:"text-xs font-normal text-secondary ml-2",children:"(alleen-lezen)"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:c.map(s=>{const t=b[s],r=h[s]||.01;return e.jsxs("div",{className:"p-4 border border-theme rounded-lg",children:[e.jsx("p",{className:"font-medium mb-2",children:t.appName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-secondary",children:"€"}),e.jsx("input",{type:"number",step:"0.001",defaultValue:r,className:"flex-1 px-3 py-2 rounded-lg border border-theme bg-white dark:bg-gray-800 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!o,readOnly:!o}),e.jsxs("span",{className:"text-sm text-secondary",children:["per ",t.creditUnit]})]}),o&&e.jsx("p",{className:"text-xs text-secondary mt-2",children:"* Prijswijzigingen momenteel niet actief"})]},s)})})]}),e.jsxs("div",{className:"bg-card rounded-xl border border-theme overflow-x-auto",children:[e.jsx("div",{className:"p-4 border-b border-theme",children:e.jsx("h3",{className:"font-semibold",children:"Kosten per Gebruiker"})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50 border-b border-theme",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Gebruiker"}),c.map(s=>e.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:b[s]?.appName},s)),e.jsx("th",{className:"text-right px-4 py-3 font-semibold",children:"Totaal"})]})}),e.jsx("tbody",{children:i.costPerUser.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:c.length+2,className:"px-4 py-8 text-center text-secondary",children:"Geen kosten geregistreerd"})}):i.costPerUser.slice(0,20).map(s=>e.jsxs("tr",{className:"border-b border-theme last:border-0 hover:bg-gray-50 dark:hover:bg-gray-800/30",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.displayName||"Onbekend"}),e.jsx("p",{className:"text-sm text-secondary",children:s.email})]})}),c.map(t=>{const a=s.apps[t]?.totalUsedThisMonth||0,l=a*(h[t]||.01);return e.jsx("td",{className:"px-4 py-3 text-center text-secondary",children:a>0?`€${l.toFixed(2)}`:"-"},t)}),e.jsxs("td",{className:"px-4 py-3 text-right font-medium",children:["€",s.totalCost.toFixed(2)]})]},s.uid))})]})]}),e.jsxs("div",{className:"bg-card rounded-xl border border-theme p-5",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Maandelijkse Trend"}),e.jsx("div",{className:"h-48 flex items-center justify-center bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsxs("div",{className:"text-center text-secondary",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 block",children:"show_chart"}),e.jsx("p",{className:"text-sm",children:"Kostengrafiek komt binnenkort"})]})})]})]})}export{w as default};

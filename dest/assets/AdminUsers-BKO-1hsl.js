import{r as o,j as e,R as w,u as R,p as G,n as f,q as S,m as A,t as j,w as E}from"./index-BbC9A4N7.js";function U({user:t,onClose:g,onSave:c}){const[p,h]=o.useState("none"),[b,i]=o.useState("none"),[m,u]=o.useState(!1);o.useEffect(()=>{t&&(h(t.appRoles?.nieuwsbriefgenerator??"none"),i(t.appRoles?.gastenregistratie??"none"))},[t]);const y=async()=>{u(!0);try{await c({appRoles:{nieuwsbriefgenerator:p==="none"?void 0:"administrator",gastenregistratie:b==="none"?void 0:"administrator"}}),g()}catch(x){console.error("Error saving user roles:",x)}finally{u(!1)}};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-xl w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Gebruiker bewerken"}),e.jsx("button",{onClick:g,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined transform rotate-45",children:"add"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Email"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300",children:t.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Global Role"}),e.jsxs("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[t.role===w.SUPERVISOR?e.jsx("span",{className:"material-symbols-outlined text-purple-500 text-sm",children:"shield_person"}):e.jsx("span",{className:"material-symbols-outlined text-gray-400 text-sm",children:"person"}),e.jsx("span",{className:"capitalize",children:t.role||"User"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"De globale rol kan niet hier gewijzigd worden."})]}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-800"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-4",children:"App Rollen"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Nieuwsbrief Generator"}),e.jsxs("select",{value:p,onChange:x=>h(x.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 outline-none transition-shadow",children:[e.jsx("option",{value:"none",children:"Geen toegang (Gebruiker)"}),e.jsx("option",{value:"administrator",children:"Administrator"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Gastenregistratie"}),e.jsxs("select",{value:b,onChange:x=>i(x.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 outline-none transition-shadow",children:[e.jsx("option",{value:"none",children:"Geen toegang (Gebruiker)"}),e.jsx("option",{value:"administrator",children:"Administrator"})]})]})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-800 flex justify-end gap-3",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 text-gray-600 hover:bg-gray-200/50 rounded-lg transition-colors font-medium",children:"Annuleren"}),e.jsxs("button",{onClick:y,disabled:m,className:"px-4 py-2 bg-[#2860E0] hover:bg-blue-700 text-white rounded-lg transition-colors font-medium flex items-center gap-2",children:[m&&e.jsx("span",{className:"material-symbols-outlined animate-spin text-sm",children:"sync"}),"Opslaan"]})]})]})}):null}function z(){const{isSupervisor:t,user:g}=R(),[c,p]=o.useState([]),[h,b]=o.useState(!0),[i,m]=o.useState(null);o.useEffect(()=>{(async()=>{try{b(!0);const l=G(f,"users"),r=(await S(l)).docs.map(d=>{const a=d.data();return{id:d.id,...a,...a,newsletterRole:a.appRoles?.nieuwsbriefgenerator||"none",gastenRole:a.appRoles?.gastenregistratie||"none"}});r.sort((d,a)=>(d.email||"").localeCompare(a.email||"")),p(r)}catch(l){console.error("Error fetching users:",l)}finally{b(!1)}})()},[]);const u=async s=>{if(i)try{const l=A(f,"users",i.id),n={},r=s.appRoles||{};r.nieuwsbriefgenerator?n["appRoles.nieuwsbriefgenerator"]=r.nieuwsbriefgenerator:r.nieuwsbriefgenerator===void 0&&(n["appRoles.nieuwsbriefgenerator"]=j()),r.gastenregistratie?n["appRoles.gastenregistratie"]=r.gastenregistratie:r.gastenregistratie===void 0&&(n["appRoles.gastenregistratie"]=j()),Object.keys(n).length>0&&(await E(l,n),p(d=>d.map(a=>{if(a.id===i.id){const v=r.nieuwsbriefgenerator||"none",k=r.gastenregistratie||"none";return{...a,newsletterRole:v,gastenRole:k,appRoles:{...a.appRoles||{},nieuwsbriefgenerator:r.nieuwsbriefgenerator,gastenregistratie:r.gastenregistratie}}}return a}))),m(null)}catch(l){console.error("Error updating user roles:",l),alert("Er is een fout opgetreden bij het opslaan van de rollen.")}},y=s=>s==="supervisor"?{label:"Supervisor",class:"bg-purple-500/10 text-purple-600 dark:text-purple-400"}:{label:"Gebruiker",class:"bg-gray-500/10 text-gray-600 dark:text-gray-400"},x=s=>s==="administrator"?{label:"Admin",class:"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400"}:{label:"Gebruiker",class:"bg-gray-500/10 text-gray-600 dark:text-gray-400"},N=s=>s==="administrator"?{label:"Admin",class:"bg-orange-500/10 text-orange-600 dark:text-orange-400"}:{label:"Gebruiker",class:"bg-gray-500/10 text-gray-600 dark:text-gray-400"};return h?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"material-symbols-outlined text-4xl animate-spin text-[#2860E0]",children:"sync"})}):e.jsxs("div",{className:"space-y-6 max-w-7xl",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gebruikers"}),e.jsx("p",{className:"text-secondary mt-1",children:"Beheer alle gebruikers en hun rollen"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-card rounded-xl border border-theme p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-12 rounded-lg bg-blue-500/10 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-blue-500",children:"group"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-sm text-secondary",children:"Totaal Gebruikers"})]})]})}),e.jsx("div",{className:"bg-card rounded-xl border border-theme p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-12 rounded-lg bg-purple-500/10 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-purple-500",children:"shield_person"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(s=>s.role==="supervisor").length}),e.jsx("p",{className:"text-sm text-secondary",children:"Supervisors"})]})]})}),e.jsx("div",{className:"bg-card rounded-xl border border-theme p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-12 rounded-lg bg-emerald-500/10 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-emerald-500",children:"admin_panel_settings"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(s=>s.newsletterRole==="administrator").length}),e.jsx("p",{className:"text-sm text-secondary",children:"App Admins"})]})]})})]}),e.jsx("div",{className:"bg-card rounded-xl border border-theme overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50 border-b border-theme",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Gebruiker"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Rol"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Nieuwsbrief Generator"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Gastenregistratie"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Laatste Login"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Aangemaakt"}),t&&e.jsx("th",{className:"text-right px-4 py-3 font-semibold",children:"Acties"})]})}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:t?6:5,className:"px-4 py-12 text-center text-secondary",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 block",children:"group"}),e.jsx("p",{children:"Geen gebruikers gevonden"})]})}):c.map(s=>{const l=y(s.role),n=x(s.newsletterRole),r=N(s.gastenRole),d=s.id===g?.uid;return e.jsxs("tr",{className:"border-b border-theme last:border-0 hover:bg-gray-50 dark:hover:bg-gray-800/30",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-10 rounded-full bg-[#2860E0] flex items-center justify-center text-white font-medium shrink-0",children:(s.displayName||s.email||"?").charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.displayName||"Onbekend",d&&e.jsx("span",{className:"text-xs text-secondary",children:"(jij)"})]}),e.jsx("p",{className:"text-sm text-secondary",children:s.email})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${l.class}`,children:l.label})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${n.class}`,children:n.label})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${r.class}`,children:r.label})}),e.jsx("td",{className:"px-4 py-3 text-secondary text-sm",children:s.lastLogin?new Date(s.lastLogin.toDate?.()||s.lastLogin).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}),e.jsx("td",{className:"px-4 py-3 text-secondary text-sm",children:s.createdAt?new Date(s.createdAt.toDate?.()||s.createdAt).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"}):"-"}),t&&e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{onClick:()=>m(s),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-500 hover:text-gray-900 dark:hover:text-gray-100",title:"Bewerken",children:e.jsx("span",{className:"material-symbols-outlined",children:"edit"})})})})]},s.id)})})]})}),!t&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-500/10 rounded-lg text-blue-600 dark:text-blue-400",children:[e.jsx("span",{className:"material-symbols-outlined",children:"info"}),e.jsx("p",{className:"text-sm",children:"Als admin heb je alleen-lezen toegang. Neem contact op met een supervisor voor het wijzigen van gebruikersrollen."})]}),i&&e.jsx(U,{user:i,onClose:()=>m(null),onSave:u})]})}export{z as default};

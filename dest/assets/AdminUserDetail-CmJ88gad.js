import{h as R,k as E,u as G,r as o,j as e,m as p,n as b,o as u,C as U}from"./index-CfLVizZX.js";import{A as f}from"./appCredits-1NRqVBd7.js";function L(){const{userId:d}=R(),g=E(),{isSupervisor:k}=G(),[m,w]=o.useState(null),[j,h]=o.useState({}),[S,C]=o.useState(!0),[y,N]=o.useState({}),[D,x]=o.useState({});o.useEffect(()=>{(async()=>{if(d)try{const t=p(b,"users",d),a=await u(t);if(a.exists())w({id:a.id,...a.data()});else{console.error("User not found"),g("/admin/users");return}const r=Object.keys(f),l={};for(const i of r){const c=p(b,"users",d,"apps",i),n=await u(c);n.exists()?l[i]=n.data():l[i]=null}h(l)}catch(t){console.error("Error fetching details:",t)}finally{C(!1)}})()},[d,g]);const v=(s,t,a)=>{h(r=>({...r,[s]:{...r[s]||{},[t]:a}})),x(r=>({...r,[s]:!1}))},A=async s=>{N(t=>({...t,[s]:!0})),x(t=>({...t,[s]:!1}));try{const t=p(b,"users",d,"apps",s),a=j[s]||{},r=await u(t),l=r.exists()?r.data():{},i={role:a.role||"user"};if(l.creditsRemaining!==void 0){const n=parseInt(a.creditsRemaining,10);isNaN(n)||(i.creditsRemaining=Math.max(0,n))}await U(t,i,{merge:!0});const c=await u(t);h(n=>({...n,[s]:c.data()})),x(n=>({...n,[s]:!0})),setTimeout(()=>{x(n=>({...n,[s]:!1}))},3e3)}catch(t){console.error(`Error saving ${s}:`,t),alert("Er is een fout opgetreden bij het opslaan.")}finally{N(t=>({...t,[s]:!1}))}};return S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("span",{className:"material-symbols-outlined text-4xl animate-spin text-[#2860E0]",children:"sync"})}):m?k?e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>g("/admin/users"),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gebruiker Details"}),e.jsx("p",{className:"text-secondary text-sm",children:"Beheer app-specifieke instellingen voor deze gebruiker"})]})]}),e.jsxs("div",{className:"bg-card rounded-xl border border-theme p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 border-b border-theme pb-2 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-lg",children:"person"}),"Algemene Informatie"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Naam"}),e.jsx("div",{className:"text-primary font-medium",children:m.displayName||"Onbekend"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Email"}),e.jsx("div",{className:"text-primary font-medium",children:m.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Globale Rol"}),e.jsx("div",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-sm font-medium bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:m.role==="supervisor"?"Supervisor":"Gebruiker"}),e.jsxs("p",{className:"text-xs text-secondary mt-1 flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-xs",children:"lock"}),"Alleen-lezen"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"User ID"}),e.jsx("div",{className:"text-xs font-mono text-secondary max-w-full overflow-hidden text-ellipsis",children:m.id})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold text-xl px-1 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"apps"}),"App Instellingen"]}),Object.keys(f).map(s=>{const t=f[s],a=j[s],r=a&&a.creditsRemaining!==void 0,l=t.hasCredits&&r,i=a?.totalGenerations;return e.jsxs("div",{className:"bg-card rounded-xl border border-theme p-6 transition-all hover:border-[var(--color-primary)]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg",children:t.appName}),e.jsx("p",{className:"text-sm text-secondary mt-0.5",children:t.description}),e.jsx("p",{className:"text-xs text-secondary font-mono mt-1",children:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a===null&&e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-800 text-secondary px-2 py-1 rounded",children:"Nog niet geconfigureerd"}),D[s]&&e.jsxs("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-2 py-1 rounded flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"check"}),"Opgeslagen"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"App Rol"}),e.jsxs("select",{value:a?.role||"user",onChange:c=>v(s,"role",c.target.value),className:"w-full px-3 py-2 bg-[var(--bg-app)] border border-theme rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2860E0]",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"administrator",children:"Administrator"})]})]}),l?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Resterende Credits"}),e.jsx("input",{type:"number",min:"0",value:a.creditsRemaining,onChange:c=>v(s,"creditsRemaining",c.target.value),className:"w-full px-3 py-2 bg-[var(--bg-app)] border border-theme rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2860E0]"}),t.monthlyLimit&&e.jsxs("p",{className:"text-xs text-secondary mt-1",children:["Limiet: ",t.monthlyLimit," ",t.creditUnitPlural,"/maand"]})]}):t.hasCredits?e.jsx("div",{className:"flex items-center",children:e.jsx("p",{className:"text-sm text-secondary italic",children:"Geen credits geÃ¯nitialiseerd voor deze gebruiker."})}):e.jsx("div",{className:"flex items-center",children:e.jsx("p",{className:"text-sm text-secondary italic",children:"Deze app gebruikt geen credits."})}),i!==void 0&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-3",children:[e.jsx("span",{className:"block text-xs text-secondary uppercase tracking-wider",children:"Totaal Generaties"}),e.jsx("span",{className:"block text-xl font-mono font-medium",children:i})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:()=>A(s),disabled:y[s],className:"px-4 py-2 bg-[#2860E0] text-white rounded-lg hover:bg-[#1C4DAB] transition-colors disabled:opacity-50 flex items-center gap-2",children:[y[s]?e.jsx("span",{className:"material-symbols-outlined text-sm animate-spin",children:"sync"}):e.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Opslaan"]})})]},s)})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-500/10 rounded-lg text-blue-600 dark:text-blue-400",children:[e.jsx("span",{className:"material-symbols-outlined mt-0.5",children:"info"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Let op:"})," Wijzigingen worden opgeslagen naar ",e.jsxs("code",{className:"bg-blue-500/20 px-1 rounded",children:["users/","{uid}","/apps/","{appId}"]}),"."]}),e.jsx("p",{children:"Credits kunnen alleen worden aangepast als het veld al bestaat. Nieuwe credits worden automatisch aangemaakt bij eerste gebruik van de app."})]})]})]}):e.jsx("div",{className:"p-4",children:"Geen toegang. Alleen supervisors mogen gebruikersinstellingen beheren."}):e.jsx("div",{className:"p-4",children:"Gebruiker niet gevonden."})}export{L as default};

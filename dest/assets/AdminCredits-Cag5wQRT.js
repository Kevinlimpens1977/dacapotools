import{u as g,r as o,t as j,j as e,w as b}from"./index-BJVU1ABf.js";import{g as f,A as y}from"./appCredits-BgLXLukM.js";function C(){const{isSupervisor:m}=g(),[i,x]=o.useState({}),[u,c]=o.useState(!0),d=f(),h=j(b,"getCostsSummary"),n=o.useMemo(()=>{const s=new Date,t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0");return`${t}-${a}`},[]);o.useEffect(()=>{(async()=>{c(!0);const t={},a=d.map(async r=>{try{const l=await h({appId:r});t[r]={totalUsage:l.data?.totalUsage??0,totalCost:l.data?.totalCost??0,monthKey:l.data?.monthKey??n}}catch(l){console.error(`Failed to fetch costs for ${r}:`,l),t[r]={totalUsage:0,totalCost:0,monthKey:n}}});await Promise.all(a),x(t),c(!1)})()},[n]);const p=Object.values(i).reduce((s,t)=>s+(t.totalCost||0),0);return u?e.jsx("div",{className:"flex items-content justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl animate-spin text-[#2860E0]",children:"sync"}),e.jsx("p",{className:"text-secondary mt-2 text-sm",children:"Kosten laden..."})]})}):e.jsxs("div",{className:"space-y-6 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Kosten"}),e.jsxs("p",{className:"text-secondary mt-1",children:["Overzicht van platformkosten per app (",n,")"]})]}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${m?"bg-purple-500/10 text-purple-600 dark:text-purple-400":"bg-blue-500/10 text-blue-600 dark:text-blue-400"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility"}),"Alleen-lezen"]})]}),e.jsxs("div",{className:"text-xs text-green-600 bg-green-50 dark:bg-green-900/20 px-2 py-1 rounded inline-block",children:[e.jsx("span",{className:"material-symbols-outlined text-sm align-middle mr-1",children:"cloud_done"}),"Live data via Cloud Functions"]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#2860E0] to-[#1C4DAB] rounded-xl p-6 text-white",children:[e.jsx("p",{className:"text-white/70 text-sm",children:"Totale Kosten Deze Maand"}),e.jsxs("p",{className:"text-4xl font-bold mt-2",children:["€",p.toFixed(2)]}),e.jsx("p",{className:"text-white/70 text-sm mt-2",children:"Gebaseerd op server-side aggregatie"})]}),e.jsxs("div",{className:"bg-card rounded-xl border border-theme p-5",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Kosten per App"}),e.jsx("div",{className:"space-y-4",children:d.map(s=>{const t=y[s],a=i[s]||{totalUsage:0,totalCost:0};return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"size-12 rounded-lg bg-[#2860E0]/10 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-[#2860E0]",children:s==="paco"?"image":s==="translate"?"translate":"apps"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.appName}),e.jsxs("p",{className:"text-sm text-secondary",children:[a.totalUsage," ",t.creditUnitPlural||"acties"," verbruikt"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xl font-bold",children:["€",(a.totalCost||0).toFixed(2)]}),t.hasCredits&&e.jsxs("p",{className:"text-xs text-secondary",children:["Limiet: ",t.monthlyLimit," ",t.creditUnitPlural,"/maand"]})]})]},s)})})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-500/10 rounded-lg text-blue-600 dark:text-blue-400",children:[e.jsx("span",{className:"material-symbols-outlined",children:"info"}),e.jsx("p",{className:"text-sm",children:"Kosten worden automatisch berekend door Cloud Functions. Data is read-only voor administrators."})]})]})}export{C as default};
